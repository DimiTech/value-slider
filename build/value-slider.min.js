!function(a){"use strict";function b(a,b){var c;if(void 0!==b&&void 0!==b[0]&&"INPUT"===b[0].tagName)c=b[0];else{if(void 0===b||"INPUT"!==b.tagName)throw new Error('Please supply an <input> element in which you wish to load the "ValueSlider" widget into.');c=b}var d=document.createElement("div");d.className="value-slider",c.parentNode.insertBefore(d,c),d.appendChild(c),c.style.display="none",a.parentDiv=d}function c(a,b){function c(a,b,c,d){if("function"==typeof b.tooltipLabel)if("undefined"!==b.range&&"object"==typeof b.range){if(2!==b.tooltipLabel.length)throw new Error("tooltipLabel() must be declared with 2 parameters, valueLeft and valueRight.");a.generateTooltipLabel=b.tooltipLabel}else a.generateTooltipLabel=b.tooltipLabel;else"undefined"!==b.range&&"object"==typeof b.range?a.generateTooltipLabel=function(a,b){return a+","+b}:a.generateTooltipLabel=function(a){return a};var e=String(a.generateTooltipLabel(b.maxValue,b.maxValue));if(c.textContent=e,b.vertical===!0){b.invertTooltip===!0?(i.style.marginRight="6px",a.parentDiv.style.width=c.clientWidth+d.clientWidth+23+"px"):(i.style.marginLeft="17px",a.parentDiv.style.width=c.clientWidth+d.clientWidth+23+"px");for(var f="0",g=e.length;g>=0;g--)f+="0";c.textContent=f}else i.style.display="inline-block",c.textContent=e}a.widget=document.createElement("div"),a.widget.className="value-slider-body",a.parentDiv.appendChild(a.widget),a.hide();var d=document.createElement("div");if(d.className="slider-value",a.widget.appendChild(d),b.showBuffer===!0&&void 0===b.range&&b.vertical!==!0){var e=document.createElement("div");e.className="slider-buffered",a.widget.appendChild(e),a.buffered=b.buffered||0}if("undefined"!==b.range&&"object"==typeof b.range){var f=document.createElement("div");f.className="slider-handle-left",d.appendChild(f)}if(b.showMouseAt===!0&&void 0===b.range&&b.vertical!==!0){var g=document.createElement("div");g.className="slider-mouseat",a.widget.insertBefore(g,d),a.mouseAt=0}var h=document.createElement("div");if(h.className="slider-handle-right",d.appendChild(h),b.showTooltip!==!1){var i=document.createElement("div");i.className="value-slider-tooltip";var j=document.createElement("div");b.vertical===!0?j.className="arrow-left":j.className="arrow-up";var k=document.createElement("div");k.className="tooltip-body",i.appendChild(j),i.appendChild(k),a.parentDiv.appendChild(i),c(a,b,k,j),b.invertTooltip===!0&&(b.vertical===!0?(j.className="arrow-right",a.widget.style["float"]="right",i.style["float"]="right"):(j.className="arrow-down",j.style.top=k.clientHeight+"px",a.parentDiv.removeChild(i),a.parentDiv.insertBefore(i,a.widget)),i.removeChild(j),i.appendChild(j)),a.hasTooltip=!0}}function d(a,b,c,d){if(!(c>b))throw new Error("Slider's minValue must be smaller than its maxValue.");if(a.minValue=b,a.maxValue=c,(a.maxValue-a.minValue)%d!==0)throw new Error("Slider's range (maxValue - minValue) must be divisible by step value without producing a remainder.");a.step=d}function e(a,b){a.parentDiv.className+="-vertical",a.widget.className+="-vertical";var c=a.widget.getElementsByClassName("slider-handle-right")[0];if(c.className+="-vertical",b){var d=a.widget.getElementsByClassName("slider-handle-left")[0];d.className+="-vertical"}var e=a.widget.getElementsByClassName("slider-value")[0];if(e.className+="-vertical",void 0!==a.buffered){var f=a.widget.getElementsByClassName("slider-buffered")[0];f.className+="-vertical"}a.vertical=!0}function f(a,b){var c="slider-value";a.vertical===!0&&(c+="-vertical");var d,e=a.widget.getElementsByClassName(c)[0];b?(d=100*(a.leftValue-a.minValue)/(a.maxValue-a.minValue),a.vertical===!0?(d+=(a.maxValue-a.rightValue)/(a.maxValue-a.minValue)*100,e.style.height=100-d+"%",g(a,d)):(e.style.left=d+"%",f(a))):(d=100*(a.rightValue-(a.leftValue||a.minValue))/(a.maxValue-a.minValue),a.vertical===!0?(e.style.height=d+"%",void 0===a.leftValue?e.style.top=100-d+"%":(d=100-(a.leftValue-a.minValue)/(a.maxValue-a.minValue)*100-d,e.style.top=d+"%")):e.style.width=d+"%",g(a,d),g(a,d))}function g(a,b){function c(a,b){var c=b.querySelector(".tooltip-body"),d=c.clientWidth+1,e=c.clientHeight+1,f=b.querySelector(".arrow-left");null===f&&(f=b.querySelector(".arrow-right")),d+=f.offsetWidth,b.style.width=d+"px",b.style.height=e+"px"}function d(a,b,c){var d;void 0===a.leftValue?a.vertical===!0?(d=100-b-c.clientHeight/2/a.widget.clientHeight*100,c.style.top=d+"%"):(d=b-50,c.style.left=d+"%"):(d=100*((a.rightValue+a.leftValue)/2-a.minValue)/(a.maxValue-a.minValue),a.vertical===!0?(d=100-d-c.clientHeight/2/a.widget.clientHeight*100,c.style.top=d+"%"):(d-=50,c.style.left=d+"%"))}function e(a,b){var c=b.getElementsByClassName("tooltip-body")[0];void 0===a.leftValue?c.textContent=a.generateTooltipLabel(a.rightValue):c.textContent=a.generateTooltipLabel(a.leftValue,a.rightValue)}if(a.hasTooltip===!0){var f=a.parentDiv.getElementsByClassName("value-slider-tooltip")[0];a.vertical===!0&&c(a,f),d(a,b,f),e(a,f),a.vertical===!0&&c(a,f)}}function h(a,b){var c=b%a;return c>=a/2?b=b-c+a:b-=c,b}function i(a){void 0===a.leftValue?(a.parentDiv.querySelector("input").value=a.rightValue,a.parentDiv.querySelector("input").defaultValue=a.rightValue):(a.parentDiv.querySelector("input").value=a.leftValue+","+a.rightValue,a.parentDiv.querySelector("input").defaultValue=a.leftValue+","+a.rightValue)}function j(a,b,c,d){return b>a?a=b:a>c&&(a=c),d&&(a=~~a),a}function k(a){var b=a.widget.getElementsByClassName("slider-buffered")[0];b.style.width=a.buffered+"%"}function l(a,b){void 0!==b&&n(a),m(a),q(a),void 0!==a.mouseAt&&r(a)}function m(a){var b=o(a,"right");a.rightHandleMouseDown=!1,b.onmousedown=function(c){if(c.preventDefault(),a.rightHandleMouseDown===!1&&(a.rightHandleMouseDown=!0),document.addEventListener("mouseup",function(b){a.rightHandleMouseDown&&(a.rightHandleMouseDown=!1),void 0!==a.mouseAt&&(d.style.width="0%")}),void 0!==a.mouseAt)var d=a.widget.getElementsByClassName("slider-mouseat")[0];document.addEventListener("mousemove",function(c){if(a.rightHandleMouseDown&&1===c.which){var e=p(a,c.pageX,c.pageY);a.setRightPercent(e),void 0!==a.mouseAt&&(a.mouseAt=(b.offsetLeft+10)/a.widget.offsetWidth*100,d.style.width=a.mouseAt+"%")}})}}function n(a){var b=o(a,"left");a.leftHandleMouseDown=!1,b.onmousedown=function(b){b.preventDefault(),a.leftHandleMouseDown===!1&&(a.leftHandleMouseDown=!0),document.addEventListener("mouseup",function(b){a.leftHandleMouseDown&&(a.leftHandleMouseDown=!1)}),document.addEventListener("mousemove",function(b){if(a.leftHandleMouseDown&&1===b.which){var c=p(a,b.pageX,b.pageY);a.setLeftPercent(c)}})}}function o(a,b){var c;return c=a.vertical===!0?a.widget.getElementsByClassName("slider-handle-"+b+"-vertical")[0]:a.widget.getElementsByClassName("slider-handle-"+b)[0]}function p(a,b,c){var d;return d=a.vertical===!0?1-(c-a.widget.offsetTop)/a.widget.clientHeight:(b-a.widget.offsetLeft)/a.widget.clientWidth,d=j(d,0,1,!1)}function q(a){function b(a){var b=document.createEvent("MouseEvents");b.initEvent("mousedown",!0,!0),a.dispatchEvent(b)}function c(a,b,c){var d="slider-value";c.vertical===!0&&(d+="-vertical");var e,f=c.parentDiv.getElementsByClassName(d)[0];return e=c.vertical===!0?b-f.offsetTop<f.clientHeight/2:a-f.offsetLeft>f.clientWidth/2}var d=o(a,"right");a.widget.addEventListener("mousedown",function(e){if(a.rightHandleMouseDown===!1){var f;if(void 0!==a.leftHandleMouseDown){var g=o(a,"left");if(a.leftHandleMouseDown===!1){e.preventDefault(),f=p(a,e.pageX,e.pageY);var h=c(e.clientX,e.clientY,a);h&&a.rightHandleMouseDown===!1?(b(d),a.setRightPercent(f)):a.leftHandleMouseDown===!1&&(b(g),a.setLeftPercent(f))}}else e.preventDefault(),f=p(a,e.pageX,e.pageY),b(d),a.setRightPercent(f)}})}function r(a){function b(a,b){var c=a.maxValue-a.minValue,d=b*c;return d=h(a.step,d),b=d/c}var c=a.widget.getElementsByClassName("slider-mouseat")[0];a.widget.addEventListener("mousemove",function(d){if(a.rightHandleMouseDown===!1){var e=p(a,d.pageX,d.pageY);1!==a.step&&(e=b(a,e)),a.mouseAt=j(e,0,1,!1),c.style.width=100*a.mouseAt+"%"}}),a.widget.addEventListener("mouseleave",function(b){a.mouseAt=0,c.style.width="0%"})}function s(a){var b=document.createEvent("Event");b.initEvent("change",!0,!0),void 0===a.leftValue?b.value=a.rightValue:(b.rightValue=a.rightValue,b.leftValue=a.leftValue),a.widget.dispatchEvent(b)}var t=function(a){b(this,a.element),c(this,a),d(this,a.minValue||0,a.maxValue||100,a.step||1),a.vertical===!0&&e(this,void 0!==a.range),void 0!==a.range?(this.setRightValue(a.range.rightValue||a.maxValue||100),this.setLeftValue(a.range.leftValue||a.minValue||0)):this.setValue(a.value||parseInt(this.parentDiv.getElementsByTagName("input")[0].defaultValue)||0),void 0!==this.buffered&&this.setBufferPercent(this.buffered),l(this,a.range),this.show()};t.prototype.setPercent=function(a){this.setRightPercent(a,"setPercent()")},t.prototype.setRightPercent=function(a,b){if("number"!=typeof a)throw new Error((b||"setRightPercent()")+" expects a floating point number parameter! (a value from 0.0 to 1.0)");a=a.toFixed(3);var c=~~(a*(this.maxValue-this.minValue)+this.minValue),d=void 0!==this.leftValue?this.leftValue+(this.step||1):this.minValue;this.rightValue=j(c,d,this.maxValue,!0),0!==this.step&&(this.rightValue=h(this.step,this.rightValue)),i(this),f(this),s(this)},t.prototype.setLeftPercent=function(a){if("number"!=typeof a)throw new Error("setLeftPercent() expects a floating point number parameter! (a value from 0.0 to 1.0)");a=a.toFixed(3);var b=~~(a*(this.maxValue-this.minValue)+this.minValue),c=this.rightValue?this.rightValue-(this.step||1):this.maxValue;this.leftValue=j(b,0,c,!0),0!==this.step&&(this.leftValue=h(this.step,this.leftValue)),i(this),f(this,!0),s(this)},t.prototype.setValue=function(a){this.setRightValue(a,"setValue()")},t.prototype.setRightValue=function(a,b){if("number"!=typeof a)throw new Error((b||"setRightValue()")+" expects a number parameter! (a value from "+this.minValue+" to "+this.maxValue+")");var c=void 0!==this.leftValue?this.leftValue+(this.step||1):this.minValue;this.rightValue=j(a,c,this.maxValue,!0),0!==this.step&&(this.rightValue=h(this.step,this.rightValue)),i(this),f(this),s(this)},t.prototype.setLeftValue=function(a){if("number"!=typeof a)throw new Error("setLeftValue() expects a number parameter! (a value from "+this.minValue+" to "+this.maxValue+")");var b=this.rightValue?this.rightValue-(this.step||1):this.maxValue;this.leftValue=j(a,0,b,!0),0!==this.step&&(this.leftValue=h(this.step,this.leftValue)),i(this),f(this,!0),s(this)},t.prototype.setBufferPercent=function(a){if(void 0===this.buffered)throw new Error("setBufferPercent() works only when there is a buffer");a=j(a,0,1),this.buffered=~~(100*a),k(this,a)},t.prototype.getValue=function(){return this.getRightValue()},t.prototype.getRightValue=function(){return this.rightValue},t.prototype.hide=function(){this.widget.style.visibility="hidden"},t.prototype.show=function(){this.widget.style.visibility="visible"},t.prototype.remove=function(){this.display("none")},t.prototype.display=function(a){var b=a||"block";this.widget.style.display=b},a.ValueSlider=t}(window);